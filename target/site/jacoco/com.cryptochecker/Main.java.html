<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Main.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">crypto-checker</a> &gt; <a href="index.source.html" class="el_package">com.cryptochecker</a> &gt; <span class="el_source">Main.java</span></div><h1>Main.java</h1><pre class="source lang-java linenums">package com.cryptochecker;

import java.awt.*; // user interfaces, painting and images. (color, font, borderlayout)
import java.awt.image.BufferedImage;
import java.io.*;
import java.util.ArrayList;
import javax.imageio.ImageIO;
import javax.swing.*; // provides gui related components (frame, jbutton)

<span class="fc" id="L10">public class Main {</span>
    public static Main gui;
    public static JFrame frame;

    public Debug debug;
    public WebData webData;
    public Menu menu;
    public PanelCoin panelCoin;
    public PanelPortfolio panelPortfolio;
    public PanelConverter panelConverter;
    public PanelSettings panelSettings;

<span class="fc" id="L22">    public static String currency = &quot;USD&quot;;</span>
<span class="fc" id="L23">    public static String currencyChar = &quot;$&quot;;</span>

<span class="fc" id="L25">    public static enum themes { LIGHT, DARK, CUSTOM };</span>
    public static Theme theme;

<span class="fc" id="L28">    public static Dimension screenResolution = Toolkit.getDefaultToolkit().getScreenSize();</span>

    public static final int panelWidth = 110;
    public static final int panelHeight = 30;

<span class="fc" id="L33">    public static final Font tableFont = new Font(&quot;Helvetica&quot;, Font.PLAIN, 16);</span>
<span class="fc" id="L34">    public static final Dimension tableHeaderSize = new Dimension(25, 25);</span>
<span class="fc" id="L35">    public static final Dimension tableIntercellSpacing = new Dimension(5, 5);</span>

<span class="fc" id="L37">    public static final String folderLocation = System.getProperty(&quot;user.home&quot;)+&quot;/.crypto-checker/&quot;;</span>
<span class="fc" id="L38">    public static final String dataSerLocation = folderLocation+&quot;data.ser&quot;;</span>
<span class="fc" id="L39">    public static final String portfolioSerLocation = folderLocation+&quot;portfolio.ser&quot;;</span>
<span class="fc" id="L40">    public static final String settingsSerLocation = folderLocation+&quot;settings.ser&quot;;</span>
<span class="fc" id="L41">    public static final String converterSerLocation = folderLocation+&quot;converter.ser&quot;;</span>
<span class="fc" id="L42">    public static final String imageLocation = folderLocation+&quot;icon.png&quot;;</span>
<span class="fc" id="L43">    public static final String logLocation = folderLocation+&quot;log.txt&quot;;</span>

    public static void main(String[] args) {
<span class="nc bnc" id="L46" title="All 2 branches missed.">        if (!(new File(folderLocation).exists())) {</span>
<span class="nc" id="L47">            new File(folderLocation).mkdirs();</span>
        }
        
<span class="nc" id="L50">        gui = new Main();</span>

        try {
<span class="nc" id="L53">            gui.setupGUI(); // create gui</span>
<span class="nc" id="L54">        } catch(Exception ex) {</span>
<span class="nc" id="L55">            ex.printStackTrace();</span>
<span class="nc" id="L56">        }</span>
<span class="nc" id="L57">    }</span>

    private void setupGUI() throws Exception {
<span class="nc" id="L60">        debug = new Debug(); // log file</span>

<span class="nc" id="L62">        frame = new JFrame(&quot;Crypto Checker&quot;); // create frame of program</span>
<span class="nc" id="L63">        frame.setSize(900,600);</span>
<span class="nc" id="L64">        frame.setLocationRelativeTo(null); // screen location to middle</span>
<span class="nc" id="L65">        frame.setResizable(false); // disallow changes to size</span>
<span class="nc" id="L66">        frame.setVisible(true);</span>
<span class="nc" id="L67">        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span>

<span class="nc" id="L69">        deserializeSettings();</span>

<span class="nc" id="L71">        getIcon();</span>
<span class="nc" id="L72">        webData = new WebData();</span>

<span class="nc" id="L74">        deserializePortfolio();</span>

<span class="nc" id="L76">        menu = new Menu();</span>
<span class="nc" id="L77">        panelCoin = new PanelCoin();</span>
<span class="nc" id="L78">        panelPortfolio = new PanelPortfolio();</span>
<span class="nc" id="L79">        panelConverter = new PanelConverter();</span>
<span class="nc" id="L80">        panelSettings = new PanelSettings();</span>

<span class="nc bnc" id="L82" title="All 2 branches missed.">        if (!Debug.mode) new WebData.RefreshCoins(); // refresh upon startup unless in debug mode</span>

        // add the panels to the frame
<span class="nc" id="L85">        frame.getContentPane().add(BorderLayout.CENTER, panelCoin.panel);</span>
<span class="nc" id="L86">        frame.getContentPane().add(BorderLayout.WEST, menu.panel);</span>

<span class="nc" id="L88">        Main.frame.getContentPane().revalidate();</span>
<span class="nc" id="L89">        Main.frame.getContentPane().repaint();</span>
<span class="nc" id="L90">    }</span>

    private void deserializeSettings() throws Exception { // restore theme setting from data
<span class="pc bpc" id="L93" title="1 of 2 branches missed.">        if (!(new File(settingsSerLocation).canRead())) {</span>
<span class="nc" id="L94">            theme = new Theme(themes.LIGHT);</span>
<span class="nc" id="L95">            Debug.log(&quot;ERROR: Couldn't find &quot;+settingsSerLocation+&quot;.. skipping&quot;);</span>
        } else {

            try {
<span class="fc" id="L99">                FileInputStream file = new FileInputStream(settingsSerLocation);</span>
<span class="fc" id="L100">                BufferedInputStream buffer = new BufferedInputStream(file);</span>
<span class="fc" id="L101">                ObjectInputStream in = new ObjectInputStream(buffer);</span>
    
<span class="fc" id="L103">                Debug.mode = (Boolean) in.readObject();</span>
<span class="fc" id="L104">                theme = (Theme) in.readObject();</span>
<span class="fc" id="L105">                currency = (String) in.readObject();</span>
<span class="fc" id="L106">                currencyChar = (String) in.readObject();</span>
<span class="fc" id="L107">                in.close();</span>
<span class="fc" id="L108">                Debug.log(&quot;Deserialized Settings From &quot; + settingsSerLocation);</span>

<span class="fc bfc" id="L110" title="All 2 branches covered.">                if (Debug.mode) Debug.frame.setVisible(true); // if debug mode on, show debug frame</span>
<span class="fc" id="L111">            } catch(Exception ex) {</span>
<span class="fc" id="L112">                Debug.log(&quot;ERROR: Main.deserializeSettings(), deleting &quot; + settingsSerLocation);</span>
<span class="fc" id="L113">                File deleteFile = new File(settingsSerLocation);</span>
<span class="fc" id="L114">                deleteFile.delete();</span>

<span class="fc" id="L116">                theme = new Theme(themes.LIGHT);</span>
<span class="fc" id="L117">            }</span>
        }

<span class="fc" id="L120">        UIManager.put(&quot;OptionPane.background&quot;,theme.emptyBackground);</span>
<span class="fc" id="L121">        UIManager.put(&quot;Panel.background&quot;,theme.emptyBackground);</span>
<span class="fc" id="L122">        UIManager.put(&quot;OptionPane.messageForeground&quot;,theme.foreground);</span>
<span class="fc" id="L123">    }</span>

    @SuppressWarnings(&quot;unchecked&quot;) // coin = (ArrayList&lt;Coin&gt; in.readObject()) supressing
    private void deserializePortfolio() throws Exception {
<span class="pc bpc" id="L127" title="1 of 2 branches missed.">        if (!(new File(portfolioSerLocation).canRead())) {</span>
<span class="nc" id="L128">            webData.portfolio = new ArrayList&lt;ArrayList&lt;WebData.Coin&gt;&gt;();</span>
<span class="nc" id="L129">            webData.portfolio.add(new ArrayList&lt;WebData.Coin&gt;());</span>
<span class="nc" id="L130">            webData.portfolio_names.add(new String(&quot;Portfolio 1&quot;));</span>
<span class="nc" id="L131">            Debug.log(&quot;ERROR: Couldn't find &quot;+portfolioSerLocation+&quot;.. skipping&quot;);</span>
        } else {

            try {
<span class="fc" id="L135">                FileInputStream file = new FileInputStream(portfolioSerLocation);</span>
<span class="fc" id="L136">                BufferedInputStream buffer = new BufferedInputStream(file);</span>
<span class="fc" id="L137">                ObjectInputStream in = new ObjectInputStream(buffer);</span>
        
<span class="fc" id="L139">                webData.portfolio = (ArrayList&lt;ArrayList&lt;WebData.Coin&gt;&gt;) in.readObject();</span>
<span class="fc" id="L140">                webData.portfolio_names = (ArrayList&lt;String&gt;) in.readObject();</span>
<span class="fc" id="L141">                webData.portfolio_nr = (Integer) in.readObject();</span>
<span class="fc" id="L142">                in.close();</span>
<span class="fc" id="L143">                Debug.log(&quot;Deserialized Portfolio From &quot; + portfolioSerLocation);</span>
            }
<span class="fc" id="L145">            catch(Exception ex) {</span>
<span class="fc" id="L146">                Debug.log(&quot;ERROR: Main.deserializePortfolio(), deleting &quot; + portfolioSerLocation);</span>
<span class="fc" id="L147">                File deleteFile = new File(portfolioSerLocation);</span>
<span class="fc" id="L148">                deleteFile.delete();</span>

<span class="fc" id="L150">                webData.portfolio = new ArrayList&lt;ArrayList&lt;WebData.Coin&gt;&gt;();</span>
<span class="fc" id="L151">                webData.portfolio.add(new ArrayList&lt;WebData.Coin&gt;());</span>
<span class="fc" id="L152">                webData.portfolio_names.add(new String(&quot;Portfolio 1&quot;));</span>
<span class="fc" id="L153">            }</span>
        }
<span class="fc" id="L155">    }</span>

    private void getIcon() throws Exception { // program icon
<span class="fc bfc" id="L158" title="All 2 branches covered.">        if (!(new File(imageLocation).exists())) {</span>
            try {
<span class="fc" id="L160">                Debug.log(&quot;ERROR: Couldn't find &quot;+imageLocation+&quot;.. downloading&quot;); // get image from jar</span>
<span class="fc" id="L161">                BufferedImage image = ImageIO.read(getClass().getResource(&quot;/icon.png&quot;));</span>

<span class="fc" id="L163">                ImageIO.write(image, &quot;png&quot;, new File(imageLocation)); // write the image to location</span>
<span class="fc" id="L164">                Debug.log(&quot;-- image downloaded&quot;);</span>
<span class="nc" id="L165">            } catch(Exception ex) {</span>
<span class="nc" id="L166">                Debug.log(&quot;ERROR: Couldn't find /icon.png in jar&quot;);</span>
<span class="nc" id="L167">                return;</span>
<span class="fc" id="L168">            }</span>
        }
        
<span class="pc bpc" id="L171" title="1 of 2 branches missed.">        if (imageLocation != null) { // do this if the image exists</span>
<span class="fc" id="L172">            frame.setIconImage(Toolkit.getDefaultToolkit().getImage(imageLocation));</span>
        }
<span class="fc" id="L174">    }</span>

    public static class Theme implements Serializable {
        private static final long serialVersionUID = 1L;
        public themes currentTheme;
        public Color background;
        public Color foreground;
        public Color green;
        public Color red;
        public Color selection;
        public Color emptyBackground;

<span class="fc" id="L186">        private Color defaultCustomBackground = new Color(0, 0, 0); // black </span>
<span class="fc" id="L187">        private Color defaultCustomForeground = new Color(14, 255, 0); // light green</span>
<span class="fc" id="L188">        private Color defaultCustomGreen = new Color(244, 255, 0); // light yellow</span>
<span class="fc" id="L189">        private Color defaultCustomRed = new Color(255, 0, 0); // light red</span>
<span class="fc" id="L190">        private Color defaultCustomSelection = new Color(128, 128, 128); // gray</span>
<span class="fc" id="L191">        private Color defaultCustomEmptyBackground = new Color(45, 45, 45); // dark gray</span>

        public Color customBackground;
        public Color customForeground;
        public Color customGreen;
        public Color customRed;
        public Color customSelection;
        public Color customEmptyBackground;

<span class="fc" id="L200">        public Theme(themes currentTheme) {</span>
<span class="fc" id="L201">            resetCustom();</span>
<span class="fc" id="L202">            this.currentTheme = currentTheme;</span>
<span class="fc" id="L203">            update();</span>
<span class="fc" id="L204">        }</span>

        public void change(themes currentTheme) {
<span class="fc" id="L207">            this.currentTheme = currentTheme;</span>
<span class="fc" id="L208">            update();</span>
<span class="fc" id="L209">        }</span>

        public void update() {
<span class="pc bpc" id="L212" title="1 of 4 branches missed.">            switch (currentTheme) {</span>
                case LIGHT:
<span class="fc" id="L214">                    background = Color.WHITE; // white</span>
<span class="fc" id="L215">                    foreground = Color.BLACK; // black</span>
<span class="fc" id="L216">                    green = new Color(0, 128, 0); // dark green</span>
<span class="fc" id="L217">                    red = new Color(220, 20, 60); // dark red</span>
<span class="fc" id="L218">                    selection = Color.GRAY; // gray</span>
<span class="fc" id="L219">                    emptyBackground = new Color(250, 250, 250); // quite white</span>
<span class="fc" id="L220">                    break;</span>
                case DARK:
<span class="fc" id="L222">                    background = new Color(15, 15, 15); // light black</span>
<span class="fc" id="L223">                    foreground = Color.WHITE; // white</span>
<span class="fc" id="L224">                    green = Color.GREEN; // light green</span>
<span class="fc" id="L225">                    red = Color.RED; // dark red</span>
<span class="fc" id="L226">                    selection = Color.GRAY; // gray</span>
<span class="fc" id="L227">                    emptyBackground = new Color(78, 78, 78); // dark gray</span>
<span class="fc" id="L228">                    break;</span>
                case CUSTOM:
<span class="fc" id="L230">                    background = customBackground;</span>
<span class="fc" id="L231">                    foreground = customForeground;</span>
<span class="fc" id="L232">                    green = customGreen;</span>
<span class="fc" id="L233">                    red = customRed;</span>
<span class="fc" id="L234">                    selection = customSelection;</span>
<span class="fc" id="L235">                    emptyBackground = customEmptyBackground;</span>
                    break;
            }
<span class="fc" id="L238">        }</span>

        public void resetCustom() {
<span class="fc" id="L241">            customBackground = defaultCustomBackground;</span>
<span class="fc" id="L242">            customForeground = defaultCustomForeground;</span>
<span class="fc" id="L243">            customGreen = defaultCustomGreen;</span>
<span class="fc" id="L244">            customRed = defaultCustomRed;</span>
<span class="fc" id="L245">            customSelection = defaultCustomSelection;</span>
<span class="fc" id="L246">            customEmptyBackground = defaultCustomEmptyBackground;</span>
<span class="fc" id="L247">        }</span>
    } 

    public JButton getButtonTemplate(String s) {
<span class="fc" id="L251">        JButton template = new JButton(s);</span>
<span class="fc" id="L252">        template.setMinimumSize(new Dimension(panelWidth, panelHeight));</span>
<span class="fc" id="L253">        template.setMaximumSize(new Dimension(panelWidth, panelHeight));</span>
<span class="fc" id="L254">        template.setBackground(Color.GRAY);</span>
<span class="fc" id="L255">        template.setForeground(Color.WHITE);</span>
<span class="fc" id="L256">        template.setFocusable(false);</span>

<span class="fc" id="L258">        return template;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>