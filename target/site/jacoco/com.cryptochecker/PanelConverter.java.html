<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>PanelConverter.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">crypto-checker</a> &gt; <a href="index.source.html" class="el_package">com.cryptochecker</a> &gt; <span class="el_source">PanelConverter.java</span></div><h1>PanelConverter.java</h1><pre class="source lang-java linenums">package com.cryptochecker;

import java.awt.*;
import java.awt.event.*;
import java.io.*;
import java.text.DecimalFormat;
import javax.swing.*;
import javax.swing.event.DocumentEvent;
import javax.swing.event.DocumentListener;

public class PanelConverter {
    public JPanel panel;

<span class="fc" id="L14">    private final int amountHeaderButtons = 2;</span>
<span class="fc" id="L15">    private final int contentWidth = 250;</span>
<span class="fc" id="L16">    private final int contentHeight = 45;</span>

    private JPanel contentFilling1;
    private JPanel contentFilling2;
    private JPanel contentTop;
    private JPanel contentBottom;
    private JPanel middleBottom;

    private JButton buttonCurrency1;
    private JButton buttonCurrency2;

    private double priceCurrency1;
    private double priceCurrency2;

    private JTextField fieldCurrency1;
    private JTextField fieldCurrency2;

    private String infoCurrency1;
    private String infoCurrency2;

    private JPanel overview;
    private JEditorPane overviewText;

    private JEditorPane textBox1;
    private JEditorPane textBox2;
<span class="fc" id="L41">    private final Font textBoxFont = new Font(&quot;Helvetica&quot;, Font.PLAIN, 14);</span>

<span class="fc" id="L43">    private DecimalFormat df1 = new DecimalFormat(&quot;#.##&quot;);</span>
<span class="fc" id="L44">    private DecimalFormat df2 = new DecimalFormat(&quot;#.###&quot;);</span>
<span class="fc" id="L45">    private DecimalFormat df3 = new DecimalFormat(&quot;#.####&quot;);</span>
<span class="fc" id="L46">    private DecimalFormat df4 = new DecimalFormat(&quot;#.#####&quot;);</span>
<span class="fc" id="L47">    private DecimalFormat df5 = new DecimalFormat(&quot;#.######&quot;);</span>
<span class="fc" id="L48">    private DecimalFormat df6 = new DecimalFormat(&quot;#.############&quot;);</span>

<span class="fc" id="L50">    public PanelConverter() {</span>
<span class="fc" id="L51">        panel = new JPanel();</span>
<span class="fc" id="L52">        panel.setVisible(false);</span>
<span class="fc" id="L53">        panel.setBackground(Color.WHITE);</span>
<span class="fc" id="L54">        panel.setLayout(new BoxLayout(panel, BoxLayout.Y_AXIS));</span>

        // overview data
<span class="fc" id="L57">        overview = new JPanel();</span>
<span class="fc" id="L58">        overview.setLayout(new FlowLayout());</span>
<span class="fc" id="L59">        overview.setBackground(Color.WHITE);</span>
<span class="fc" id="L60">        overview.setBorder(BorderFactory.createMatteBorder(1, 1, 1, 1, Color.GRAY));</span>
<span class="fc" id="L61">        calculateGlobal();</span>
<span class="fc" id="L62">        overview.add(overviewText);</span>

        // overview-content filling
<span class="fc" id="L65">        contentFilling1 = new JPanel();</span>
<span class="fc" id="L66">        contentFilling1.setLayout(new BorderLayout());</span>
<span class="fc" id="L67">        contentFilling1.setBorder(BorderFactory.createMatteBorder(0, 1, 0, 1, Color.GRAY));</span>

<span class="fc" id="L69">        contentFilling2 = new JPanel();</span>
<span class="fc" id="L70">        contentFilling2.setLayout(new BorderLayout());</span>
<span class="fc" id="L71">        contentFilling2.setBorder(BorderFactory.createMatteBorder(0, 1, 1, 1, Color.GRAY));</span>

        // CONTENT
<span class="fc" id="L74">        contentTop = new JPanel();</span>
<span class="fc" id="L75">        contentTop.setLayout(new FlowLayout());</span>
<span class="fc" id="L76">        contentTop.setBorder(BorderFactory.createMatteBorder(0, 1, 0, 1, Color.GRAY));</span>

<span class="fc" id="L78">        contentBottom = new JPanel();</span>
<span class="fc" id="L79">        contentBottom.setLayout(new FlowLayout());</span>
<span class="fc" id="L80">        contentBottom.setBorder(BorderFactory.createMatteBorder(0, 1, 0, 1, Color.GRAY));</span>

        // CONTENT TOP - LEFT
<span class="fc" id="L83">        JPanel topLeft = new JPanel();</span>
<span class="fc" id="L84">        topLeft.setLayout(new BoxLayout(topLeft, BoxLayout.Y_AXIS));</span>
<span class="fc" id="L85">        topLeft.setPreferredSize(new Dimension(contentWidth, contentHeight));</span>
<span class="fc" id="L86">        topLeft.setBorder(BorderFactory.createMatteBorder(1, 1, 1, 1, Color.LIGHT_GRAY));</span>

<span class="fc" id="L88">        JPanel topLeft1 = new JPanel();</span>
<span class="fc" id="L89">        topLeft1.setLayout(new BorderLayout());</span>

<span class="fc" id="L91">        buttonCurrency1 = Main.gui.getButtonTemplate(&quot;&quot;);</span>
<span class="fc" id="L92">        buttonCurrency1.addActionListener(new buttonCurrencyListener(1));</span>
<span class="fc" id="L93">        buttonCurrency1.setBorder(BorderFactory.createEmptyBorder());</span>

<span class="fc" id="L95">        topLeft1.add(buttonCurrency1);</span>

<span class="fc" id="L97">        JPanel topLeft2 = new JPanel();</span>
<span class="fc" id="L98">        topLeft2.setLayout(new BoxLayout(topLeft2, BoxLayout.Y_AXIS));</span>

<span class="fc" id="L100">        fieldCurrency1 = new JTextField(&quot;&quot;);</span>
<span class="fc" id="L101">        fieldCurrency1.setHorizontalAlignment(JTextField.CENTER);</span>
<span class="fc" id="L102">        fieldCurrency1.setMinimumSize(new Dimension(contentWidth, contentHeight/2));</span>
<span class="fc" id="L103">        fieldCurrency1.setMaximumSize(new Dimension(contentWidth, contentHeight/2));</span>
<span class="fc" id="L104">        fieldCurrency1.setBorder(BorderFactory.createEmptyBorder());</span>

<span class="fc" id="L106">        topLeft2.add(fieldCurrency1);</span>

<span class="fc" id="L108">        topLeft.add(topLeft1);</span>
<span class="fc" id="L109">        topLeft.add(topLeft2);</span>

        // CONTENT TOP - MIDDLE
<span class="fc" id="L112">        JButton bSwitch = Main.gui.getButtonTemplate(&quot;Switch&quot;);</span>
<span class="fc" id="L113">        bSwitch.addActionListener(new bSwitchListener());</span>
<span class="fc" id="L114">        bSwitch.setBorder(BorderFactory.createMatteBorder(1, 1, 1, 1, Color.LIGHT_GRAY));</span>
<span class="fc" id="L115">        bSwitch.setPreferredSize(new Dimension(contentWidth/2,contentHeight));</span>

        // CONTENT TOP - RIGHT
<span class="fc" id="L118">        JPanel topRight = new JPanel();</span>
<span class="fc" id="L119">        topRight.setLayout(new BoxLayout(topRight, BoxLayout.Y_AXIS));</span>
<span class="fc" id="L120">        topRight.setPreferredSize(new Dimension(contentWidth, contentHeight));</span>
<span class="fc" id="L121">        topRight.setBorder(BorderFactory.createMatteBorder(1, 1, 1, 1, Color.LIGHT_GRAY));</span>

<span class="fc" id="L123">        JPanel topRight1 = new JPanel();</span>
<span class="fc" id="L124">        topRight1.setLayout(new BorderLayout());</span>

<span class="fc" id="L126">        buttonCurrency2 = Main.gui.getButtonTemplate(&quot;&quot;);</span>
<span class="fc" id="L127">        buttonCurrency2.addActionListener(new buttonCurrencyListener(2));</span>
<span class="fc" id="L128">        buttonCurrency2.setBorder(BorderFactory.createEmptyBorder());</span>

<span class="fc" id="L130">        topRight1.add(buttonCurrency2);</span>

<span class="fc" id="L132">        JPanel topRight2 = new JPanel();</span>
<span class="fc" id="L133">        topRight2.setLayout(new BoxLayout(topRight2, BoxLayout.Y_AXIS));</span>

<span class="fc" id="L135">        fieldCurrency2 = new JTextField(&quot;&quot;);</span>
<span class="fc" id="L136">        fieldCurrency2.setHorizontalAlignment(JTextField.CENTER);</span>
<span class="fc" id="L137">        fieldCurrency2.setMinimumSize(new Dimension(contentWidth, contentHeight/2));</span>
<span class="fc" id="L138">        fieldCurrency2.setMaximumSize(new Dimension(contentWidth, contentHeight/2));</span>
<span class="fc" id="L139">        fieldCurrency2.setBorder(BorderFactory.createEmptyBorder());</span>
<span class="fc" id="L140">        fieldCurrency2.setBackground(Color.WHITE);</span>
<span class="fc" id="L141">        fieldCurrency2.setEditable(false);</span>

<span class="fc" id="L143">        topRight2.add(fieldCurrency2);</span>

<span class="fc" id="L145">        topRight.add(topRight1);</span>
<span class="fc" id="L146">        topRight.add(topRight2);</span>

<span class="fc" id="L148">        contentTop.add(topLeft);</span>
<span class="fc" id="L149">        contentTop.add(bSwitch);</span>
<span class="fc" id="L150">        contentTop.add(topRight);</span>

        // CONTENT BOTTOM - LEFT
<span class="fc" id="L153">        JPanel leftBottom = new JPanel();</span>
<span class="fc" id="L154">        leftBottom.setLayout(new BoxLayout(leftBottom, BoxLayout.Y_AXIS));</span>
<span class="fc" id="L155">        leftBottom.setPreferredSize(new Dimension(contentWidth, contentHeight*6));</span>
<span class="fc" id="L156">        leftBottom.setBorder(BorderFactory.createMatteBorder(1, 1, 1, 1, Color.LIGHT_GRAY));</span>

<span class="fc" id="L158">        textBox1 = new JEditorPane();</span>
<span class="fc" id="L159">        textBox1.setFont(textBoxFont);</span>
<span class="fc" id="L160">        textBox1.setEditable(false);</span>
        
<span class="fc" id="L162">        leftBottom.add(textBox1);</span>

        // CONTENT BOTTOM - MIDDLE
<span class="fc" id="L165">        middleBottom = new JPanel();</span>
<span class="fc" id="L166">        middleBottom.setLayout(new BorderLayout());</span>
<span class="fc" id="L167">        middleBottom.setPreferredSize(bSwitch.getPreferredSize());</span>

        // CONTENT BOTTOM - RIGHT
<span class="fc" id="L170">        JPanel rightBottom = new JPanel();</span>
<span class="fc" id="L171">        rightBottom.setLayout(new BoxLayout(rightBottom, BoxLayout.Y_AXIS));</span>
<span class="fc" id="L172">        rightBottom.setPreferredSize(new Dimension(contentWidth, contentHeight*6));</span>
<span class="fc" id="L173">        rightBottom.setBorder(BorderFactory.createMatteBorder(1, 1, 1, 1, Color.LIGHT_GRAY));</span>

<span class="fc" id="L175">        textBox2 = new JEditorPane();</span>
<span class="fc" id="L176">        textBox2.setFont(textBoxFont);</span>
<span class="fc" id="L177">        textBox2.setEditable(false);</span>

<span class="fc" id="L179">        rightBottom.add(textBox2);</span>

<span class="fc" id="L181">        contentBottom.add(leftBottom);</span>
<span class="fc" id="L182">        contentBottom.add(middleBottom);</span>
<span class="fc" id="L183">        contentBottom.add(rightBottom);</span>

        // currencyField1
<span class="fc" id="L186">        fieldCurrency1.getDocument().addDocumentListener(new DocumentListener() {</span>
            public void insertUpdate(DocumentEvent e) {
                Double docText;
                try { 
<span class="nc" id="L190">                    docText = Double.parseDouble(fieldCurrency1.getText());</span>
<span class="nc" id="L191">                } catch(Exception ex) {</span>
<span class="nc" id="L192">                    docText = null;</span>
                }

<span class="nc bnc" id="L195" title="All 2 branches missed.">                if (docText == null) {</span>
<span class="nc" id="L196">                    fieldCurrency2.setText(&quot;&quot;);</span>
<span class="nc" id="L197">                } else {</span>
<span class="nc" id="L198">                    fieldCurrency2.setText(calculateCurrency(docText));</span>
                }

<span class="nc" id="L201">                serialize();</span>
<span class="nc" id="L202">            }</span>

            public void removeUpdate(DocumentEvent e) {
                Double docText;
                try { 
<span class="nc" id="L207">                    docText = Double.parseDouble(fieldCurrency1.getText());</span>
<span class="nc" id="L208">                } catch(Exception ex) {</span>
<span class="nc" id="L209">                    docText = null;</span>
                }

<span class="nc bnc" id="L212" title="All 2 branches missed.">                if (docText == null) {</span>
<span class="nc" id="L213">                    fieldCurrency2.setText(&quot;&quot;);</span>
<span class="nc" id="L214">                } else {</span>
<span class="nc" id="L215">                    fieldCurrency2.setText(calculateCurrency(docText));</span>
                }

<span class="nc" id="L218">                serialize();</span>
<span class="nc" id="L219">            }</span>

            public void changedUpdate(DocumentEvent e) {
<span class="nc" id="L222">                throw new UnsupportedOperationException(&quot;Not supported yet.&quot;); // to change body of generated methods, choose Tools | Templates.</span>
            }
        });

        // TOP HEADER
<span class="fc" id="L227">        JPanel headerTop = new JPanel();</span>
<span class="fc" id="L228">        headerTop.setBackground(Color.GRAY);</span>
<span class="fc" id="L229">        headerTop.setLayout(new BoxLayout(headerTop, BoxLayout.X_AXIS));</span>

        // BUTTONS HEADER
<span class="fc" id="L232">        JPanel headerButtons = new JPanel();</span>
<span class="fc" id="L233">        headerButtons.setLayout(new BoxLayout(headerButtons, BoxLayout.X_AXIS));</span>
<span class="fc" id="L234">        headerButtons.setPreferredSize(new Dimension(Main.panelWidth*amountHeaderButtons, Main.panelHeight-1));</span>

<span class="fc" id="L236">        JButton bRefresh = Main.gui.getButtonTemplate(&quot;Refresh&quot;);</span>
<span class="fc" id="L237">        bRefresh.addActionListener(new bRefreshListener());</span>
<span class="fc" id="L238">        bRefresh.setBorder(BorderFactory.createMatteBorder(0, 1, 0, 1, Color.LIGHT_GRAY));</span>
<span class="fc" id="L239">        bRefresh.setMaximumSize(new Dimension(Main.panelWidth, Main.panelHeight+1));</span>

<span class="fc" id="L241">        JButton bGlobal = Main.gui.getButtonTemplate(&quot;Global Data&quot;);</span>
<span class="fc" id="L242">        bGlobal.addActionListener(new bGlobalListener());</span>
<span class="fc" id="L243">        bGlobal.setBorder(BorderFactory.createMatteBorder(0, 0, 0, 1, Color.LIGHT_GRAY));</span>
<span class="fc" id="L244">        bGlobal.setMaximumSize(new Dimension(Main.panelWidth, Main.panelHeight+1));</span>

<span class="fc" id="L246">        headerButtons.add(bRefresh);</span>
<span class="fc" id="L247">        headerButtons.add(bGlobal);</span>

        // HEADER FILLING
<span class="fc" id="L250">        JPanel headerFilling = new JPanel();</span>
<span class="fc" id="L251">        headerFilling.setLayout(new BorderLayout());</span>
<span class="fc" id="L252">        headerFilling.setMaximumSize(new Dimension((int) Main.screenResolution.getWidth(), Main.panelHeight-1));</span>
<span class="fc" id="L253">        headerFilling.setBackground(Color.GRAY);</span>

<span class="fc" id="L255">        themeSwitch(); // select theme color</span>

<span class="fc" id="L257">        headerTop.add(headerButtons);</span>
<span class="fc" id="L258">        headerTop.add(headerFilling);</span>

<span class="fc" id="L260">        panel.add(headerTop);</span>
<span class="fc" id="L261">        panel.add(overview);</span>
<span class="fc" id="L262">        panel.add(contentFilling1);</span>
<span class="fc" id="L263">        panel.add(contentTop);</span>
<span class="fc" id="L264">        panel.add(contentBottom);</span>
<span class="fc" id="L265">        panel.add(contentFilling2);</span>

<span class="fc" id="L267">        deserialize();</span>
<span class="fc" id="L268">        retrieveText(1, infoCurrency1);</span>
<span class="fc" id="L269">        retrieveText(2, infoCurrency2);</span>
<span class="fc" id="L270">    }</span>
    
    public void reCreate() {
<span class="fc" id="L273">        calculateGlobal();</span>

<span class="pc bfc" id="L275" title="All 2 branches covered.">        for (int i = 0; i &lt; Main.gui.webData.coin.size(); ++i) {</span>
<span class="pc bpc" id="L276" title="1 of 2 branches missed.">            if (Main.gui.webData.coin.get(i).name.equals(buttonCurrency1.getText())) {</span>
<span class="fc" id="L277">                priceCurrency1 = Main.gui.webData.coin.get(i).price;</span>
<span class="fc" id="L278">                retrieveText(1, Main.gui.webData.coin.get(i).getInfo());</span>
<span class="fc" id="L279">                break;</span>
            }
        }
<span class="pc bpc" id="L282" title="1 of 4 branches missed.">        if (priceCurrency2 != 0) for (int i = 0; i &lt; Main.gui.webData.coin.size(); ++i) {</span>
<span class="pc bpc" id="L283" title="1 of 2 branches missed.">            if (Main.gui.webData.coin.get(i).name.equals(buttonCurrency2.getText())) {</span>
<span class="nc" id="L284">                priceCurrency2 = Main.gui.webData.coin.get(i).price;</span>
<span class="nc" id="L285">                retrieveText(2, Main.gui.webData.coin.get(i).getInfo());</span>
<span class="nc" id="L286">                break;</span>
            }
<span class="fc" id="L288">        }</span>
        else { // priceCurrency2 is 0, it's value is Main.currency
<span class="nc" id="L290">            buttonCurrency2.setText(Main.currency);</span>
<span class="nc" id="L291">            fieldCurrency1.setText(fieldCurrency1.getText()); // invoke documentlistener on currency change</span>
<span class="nc" id="L292">            retrieveText(2, &quot;&quot;);</span>
        }

<span class="fc" id="L295">        fieldCurrency1.setText(fieldCurrency1.getText());</span>
<span class="nc" id="L296">        Main.frame.getContentPane().revalidate();</span>
<span class="nc" id="L297">        Main.frame.getContentPane().repaint();</span>
<span class="nc" id="L298">    }</span>

    private void retrieveText(int box, String info) {
        //Debug.log(&quot;Retrieving Box &quot;+box);

<span class="pc bpc" id="L303" title="1 of 3 branches missed.">        switch (box) {</span>
            case 1:
<span class="fc" id="L305">                infoCurrency1 = info;</span>
<span class="fc" id="L306">                textBox1.setText(infoCurrency1);</span>
<span class="fc" id="L307">                break;</span>
            case 2:
<span class="fc" id="L309">                infoCurrency2 = info;</span>
<span class="fc" id="L310">                textBox2.setText(infoCurrency2);</span>
<span class="fc" id="L311">                break;</span>
            default:
<span class="nc" id="L313">                Debug.log(&quot;incorrect case - PanelConverter.java retrieveText()&quot;);</span>
<span class="nc" id="L314">                System.exit(0);</span>
                break;
        }
<span class="fc" id="L317">    }</span>

    private String calculateCurrency(double x) {
<span class="fc" id="L320">        Double returnValue = 0.0;</span>
<span class="fc" id="L321">        String returnString = &quot;&quot;;</span>

<span class="fc bfc" id="L323" title="All 4 branches covered.">        if (priceCurrency2 == 0.0 &amp;&amp; buttonCurrency2.getText().equals(Main.currency)) {</span>
<span class="fc" id="L324">            returnValue = priceCurrency1*x;</span>
<span class="fc" id="L325">        }</span>
<span class="pc bpc" id="L326" title="1 of 4 branches missed.">        else if (priceCurrency1 == 0 || priceCurrency2 == 0) {</span>
<span class="fc" id="L327">            return String.valueOf(0);</span>
        }
        else {
<span class="fc" id="L330">            returnValue = (priceCurrency1/priceCurrency2)*x;</span>
        }

<span class="fc bfc" id="L333" title="All 2 branches covered.">        if (returnValue &gt; 1) returnString = String.valueOf(df1.format(returnValue));</span>
<span class="fc bfc" id="L334" title="All 2 branches covered.">        else if (returnValue &gt; 0.1) returnString = String.valueOf(df2.format(returnValue));</span>
<span class="fc bfc" id="L335" title="All 2 branches covered.">        else if (returnValue &gt; 0.01) returnString = String.valueOf(df3.format(returnValue));</span>
<span class="fc bfc" id="L336" title="All 2 branches covered.">        else if (returnValue &gt; 0.001) returnString = String.valueOf(df4.format(returnValue));</span>
<span class="fc bfc" id="L337" title="All 2 branches covered.">        else if (returnValue &gt; 0.0001) returnString = String.valueOf(df5.format(returnValue));</span>
<span class="fc" id="L338">        else returnString = String.valueOf(df6.format(returnValue));</span>

<span class="fc" id="L340">        return returnString;</span>
    }

    private void calculateGlobal() {
<span class="fc" id="L344">        double total_market_cap = Main.gui.webData.global_data.total_market_cap;</span>
<span class="fc" id="L345">        double total_24h_volume = Main.gui.webData.global_data.total_24h_volume;</span>
<span class="fc" id="L346">        double bitcoin_percentage = Main.gui.webData.global_data.bitcoin_percentage_of_market_cap;</span>
        
<span class="fc" id="L348">        DecimalFormat htmlFormat = new DecimalFormat(&quot;#,###.##&quot;);</span>

<span class="fc" id="L350">        String htmlFont = &quot;&lt;font color=\&quot;rgb(&quot;+Main.theme.foreground.getRed()+&quot;, &quot;+Main.theme.foreground.getGreen()+&quot;, &quot;+Main.theme.foreground.getBlue()+&quot;)\&quot;&gt;&quot;;</span>
<span class="fc" id="L351">        String htmlGreen = &quot;&lt;font color=\&quot;rgb(&quot;+Main.theme.green.getRed()+&quot;, &quot;+Main.theme.green.getGreen()+&quot;, &quot;+Main.theme.green.getBlue()+&quot;)\&quot;&gt;&quot;;</span>

<span class="fc" id="L353">        String htmlOverview = htmlFont+&quot;&lt;font size=\&quot;6\&quot;&gt;&lt;font face=\&quot;helvetica\&quot;&gt;&quot;+&quot;&lt;center&gt;&quot;</span>
<span class="fc" id="L354">        +&quot;{ &quot;+htmlFormat.format(total_market_cap)+&quot; }&lt;br&gt;&quot;</span>
<span class="fc" id="L355">        +&quot;&lt;font size=\&quot;4\&quot;&gt;&lt;b&gt;24 Hour Volume: &quot;+htmlGreen+htmlFormat.format(total_24h_volume)+htmlFont+&quot;&lt;br&gt;&quot;</span>
<span class="fc" id="L356">        +&quot;Bitcoin Dominance: &quot;+htmlGreen+bitcoin_percentage+&quot;%&quot;+htmlFont+&quot;&lt;/b&gt;&lt;/center&gt;&quot;;</span>

        // set text
<span class="fc bfc" id="L359" title="All 2 branches covered.">        if (overviewText != null) {</span>
<span class="fc" id="L360">            overviewText.setText(htmlOverview);</span>
<span class="fc" id="L361">        } else {</span>
<span class="fc" id="L362">            overviewText = new JEditorPane(&quot;text/html&quot;, htmlOverview);</span>
<span class="fc" id="L363">            overviewText.setEditable(false);</span>
        }
<span class="fc" id="L365">    }</span>

    public void themeSwitch() {
<span class="fc" id="L368">        overview.setBackground(Main.theme.background);</span>
<span class="fc" id="L369">        overviewText.setBackground(Main.theme.background);</span>
<span class="fc" id="L370">        overviewText.setForeground(Main.theme.foreground);</span>

<span class="fc" id="L372">        fieldCurrency1.setBackground(Main.theme.background);</span>
<span class="fc" id="L373">        fieldCurrency1.setForeground(Main.theme.foreground);</span>
<span class="fc" id="L374">        fieldCurrency2.setBackground(Main.theme.background);</span>
<span class="fc" id="L375">        fieldCurrency2.setForeground(Main.theme.foreground);</span>

<span class="fc" id="L377">        textBox1.setBackground(Main.theme.background);</span>
<span class="fc" id="L378">        textBox1.setForeground(Main.theme.foreground);</span>
<span class="fc" id="L379">        textBox2.setBackground(Main.theme.background);</span>
<span class="fc" id="L380">        textBox2.setForeground(Main.theme.foreground);</span>

<span class="fc" id="L382">        contentFilling1.setBackground(Main.theme.emptyBackground);</span>
<span class="fc" id="L383">        contentFilling2.setBackground(Main.theme.emptyBackground);</span>
<span class="fc" id="L384">        contentTop.setBackground(Main.theme.emptyBackground);</span>
<span class="fc" id="L385">        contentBottom.setBackground(Main.theme.emptyBackground);</span>
<span class="fc" id="L386">        middleBottom.setBackground(Main.theme.emptyBackground);</span>

<span class="fc" id="L388">        calculateGlobal();</span>
<span class="fc" id="L389">    }</span>

<span class="fc" id="L391">    private class bRefreshListener implements ActionListener {</span>
        public void actionPerformed(ActionEvent e) {
<span class="nc" id="L393">            Debug.log(&quot;Button Refresh Clicked&quot;);</span>
<span class="nc" id="L394">            new WebData.RefreshCoins();</span>
<span class="nc" id="L395">        }</span>
    }

<span class="fc" id="L398">    private class bGlobalListener implements ActionListener {</span>
        public void actionPerformed(ActionEvent e) {
<span class="nc" id="L400">            Debug.log(&quot;Button Global Clicked&quot;);</span>
<span class="nc" id="L401">            JOptionPane.showMessageDialog(Main.frame, Main.gui.webData.global_data.toString(), &quot;Global&quot;, JOptionPane.PLAIN_MESSAGE);</span>
<span class="nc" id="L402">        }</span>
    }
    
    private class buttonCurrencyListener implements ActionListener {
        private int nr;

<span class="fc" id="L408">        public buttonCurrencyListener(int nr) {</span>
<span class="fc" id="L409">            this.nr = nr;</span>
<span class="fc" id="L410">        }</span>

        public void actionPerformed(ActionEvent e) {
<span class="nc" id="L413">            Debug.log(&quot;Button Convert Currency &quot;+nr+&quot; Clicked&quot;);</span>
            int convertSelection;

<span class="nc bnc" id="L416" title="All 2 branches missed.">            if (nr == 2) {</span>
<span class="nc" id="L417">                Object[] convertSelectionOptions = { &quot;Cryptocurrency&quot;, &quot;Current currency (&quot;+Main.currency+&quot;)&quot;};</span>
<span class="nc" id="L418">                convertSelection = JOptionPane.showOptionDialog(Main.frame, &quot;Select one of the options&quot;, &quot;Selection&quot;, JOptionPane.YES_NO_CANCEL_OPTION, JOptionPane.QUESTION_MESSAGE, null, convertSelectionOptions, convertSelectionOptions[1]);</span>
<span class="nc" id="L419">                Debug.log(&quot;-- menu selection &quot; +convertSelection);</span>
<span class="nc" id="L420">            } else {</span>
<span class="nc" id="L421">                convertSelection = 0;</span>
            }

<span class="nc bnc" id="L424" title="All 3 branches missed.">            switch (convertSelection) {</span>
                case 0:
<span class="nc" id="L426">                    Object[] options = Main.gui.webData.coin.toArray();</span>

<span class="nc" id="L428">                    Object selectedValue = JOptionPane.showInputDialog(Main.frame, &quot;Select cryptocurrency to add&quot;, &quot;Add To Portfolio&quot;, JOptionPane.PLAIN_MESSAGE, null, options, options[0]);</span>
<span class="nc bnc" id="L429" title="All 2 branches missed.">                    if (selectedValue == null) {</span>
<span class="nc" id="L430">                        Debug.log(&quot;-- cancel&quot;);</span>
<span class="nc" id="L431">                        return;</span>
                    } else {
<span class="nc" id="L433">                        Debug.log(&quot;-- &quot;+selectedValue);</span>
                    }
    
<span class="nc bnc" id="L436" title="All 2 branches missed.">                    if (nr == 1) {</span>
<span class="nc" id="L437">                        buttonCurrency1.setText(selectedValue.toString());</span>
<span class="nc bnc" id="L438" title="All 2 branches missed.">                        for (int i = 0; i &lt; Main.gui.webData.coin.size(); ++i) {</span>
<span class="nc bnc" id="L439" title="All 2 branches missed.">                            if (Main.gui.webData.coin.get(i).name.equals(selectedValue.toString())) {</span>
<span class="nc" id="L440">                                priceCurrency1 = Main.gui.webData.coin.get(i).price;</span>
<span class="nc" id="L441">                                retrieveText(1, Main.gui.webData.coin.get(i).getInfo());</span>
<span class="nc" id="L442">                                break;</span>
                            }
                        }
<span class="nc bnc" id="L445" title="All 2 branches missed.">                    } else if (nr == 2) {</span>
<span class="nc" id="L446">                        buttonCurrency2.setText(selectedValue.toString());</span>
<span class="nc bnc" id="L447" title="All 2 branches missed.">                        for (int i = 0; i &lt; Main.gui.webData.coin.size(); ++i) {</span>
<span class="nc bnc" id="L448" title="All 2 branches missed.">                            if (Main.gui.webData.coin.get(i).name.equals(selectedValue.toString())) {</span>
<span class="nc" id="L449">                                priceCurrency2 = Main.gui.webData.coin.get(i).price;</span>
<span class="nc" id="L450">                                retrieveText(2, Main.gui.webData.coin.get(i).getInfo());</span>
<span class="nc" id="L451">                                break;</span>
                            }
                        }
<span class="nc" id="L454">                    } else {</span>
<span class="nc" id="L455">                        Debug.log(&quot;EXCEPTION: incorrect nr in buttonCurrencyListener&quot;);</span>
<span class="nc" id="L456">                        System.exit(0);</span>
                    }
<span class="nc" id="L458">                    break;</span>
                case 1:
<span class="nc" id="L460">                    Debug.log(&quot;-- &quot; + Main.currency);</span>
<span class="nc" id="L461">                    priceCurrency2 = 0;</span>
<span class="nc" id="L462">                    buttonCurrency2.setText(Main.currency);</span>
<span class="nc" id="L463">                    retrieveText(2, &quot;&quot;);</span>

<span class="nc" id="L465">                    break;</span>
                default:
<span class="nc" id="L467">                    Debug.log(&quot;-- cancel&quot;);</span>
<span class="nc" id="L468">                    return;</span>
            }

<span class="nc" id="L471">            fieldCurrency1.setText(fieldCurrency1.getText()); // invoke documentlistener on currency change</span>
<span class="nc" id="L472">        }</span>
    }

<span class="fc" id="L475">    private class bSwitchListener implements ActionListener {</span>
        public void actionPerformed(ActionEvent e) {
<span class="nc" id="L477">            Debug.log(&quot;Button Switch Clicked&quot;);</span>

<span class="nc bnc" id="L479" title="All 4 branches missed.">            if (priceCurrency2 == 0 || priceCurrency1 == 0) {</span>
<span class="nc" id="L480">                JOptionPane.showMessageDialog(Main.frame, &quot;You must select a cryptocurrency for both fields&quot;, &quot;Select Cryptocurrencies&quot;, JOptionPane.PLAIN_MESSAGE);</span>
<span class="nc" id="L481">                return;</span>
            }

<span class="nc" id="L484">            String button1 = buttonCurrency1.getText();</span>
<span class="nc" id="L485">            String button2 = buttonCurrency2.getText();</span>
<span class="nc" id="L486">            String field1 = fieldCurrency1.getText();</span>
<span class="nc" id="L487">            String field2 = fieldCurrency2.getText();</span>
<span class="nc" id="L488">            Double price1 = priceCurrency1;</span>
<span class="nc" id="L489">            Double price2 = priceCurrency2;</span>
<span class="nc" id="L490">            String info1 = infoCurrency1;</span>
<span class="nc" id="L491">            String info2 = infoCurrency2;</span>

<span class="nc" id="L493">            buttonCurrency1.setText(button2);</span>
<span class="nc" id="L494">            buttonCurrency2.setText(button1);</span>
<span class="nc" id="L495">            fieldCurrency1.setText(field2);</span>
<span class="nc" id="L496">            fieldCurrency2.setText(field1);</span>
<span class="nc" id="L497">            priceCurrency1 = price2;</span>
<span class="nc" id="L498">            priceCurrency2 = price1;</span>
<span class="nc" id="L499">            retrieveText(1, info2);</span>
<span class="nc" id="L500">            retrieveText(2, info1);</span>
            
<span class="nc" id="L502">            serialize();</span>
<span class="nc" id="L503">        }</span>
    }

    //@SuppressWarnings(&quot;unchecked&quot;)
    private void deserialize() {
        try {
<span class="fc bfc" id="L509" title="All 2 branches covered.">            if (!(new File(Main.converterSerLocation).canRead())) {</span>
<span class="fc" id="L510">                Debug.log(&quot;ERROR: Couldn't find &quot;+Main.converterSerLocation+&quot;.. skipping&quot;);</span>
                // default settings if none exists
<span class="fc" id="L512">                priceCurrency1 = Main.gui.webData.coin.get(0).price;</span>
<span class="fc" id="L513">                priceCurrency2 = Main.gui.webData.coin.get(1).price;</span>
<span class="fc" id="L514">                buttonCurrency1.setText(Main.gui.webData.coin.get(0).toString());</span>
<span class="fc" id="L515">                buttonCurrency2.setText(Main.gui.webData.coin.get(1).toString());</span>
<span class="fc" id="L516">                retrieveText(1, Main.gui.webData.coin.get(0).getInfo());</span>
<span class="fc" id="L517">                retrieveText(2, Main.gui.webData.coin.get(1).getInfo());</span>
<span class="fc" id="L518">                return;</span>
            }
<span class="fc" id="L520">            FileInputStream file = new FileInputStream(Main.converterSerLocation);</span>
<span class="fc" id="L521">            BufferedInputStream buffer = new BufferedInputStream(file);</span>
<span class="fc" id="L522">            ObjectInputStream in = new ObjectInputStream(buffer);</span>

<span class="fc" id="L524">            buttonCurrency1.setText((String) in.readObject());</span>
<span class="fc" id="L525">            buttonCurrency2.setText((String) in.readObject());</span>
<span class="fc" id="L526">            fieldCurrency1.setText((String) in.readObject());</span>
<span class="fc" id="L527">            fieldCurrency2.setText((String) in.readObject());</span>
<span class="fc" id="L528">            priceCurrency1 = (Double) in.readObject();</span>
<span class="fc" id="L529">            priceCurrency2 = (Double) in.readObject();</span>
<span class="fc" id="L530">            infoCurrency1 = (String) in.readObject();</span>
<span class="fc" id="L531">            infoCurrency2 = (String) in.readObject();</span>
<span class="fc" id="L532">            in.close();</span>
<span class="fc" id="L533">            Debug.log(&quot;Deserialized Converter From &quot; + Main.converterSerLocation);</span>
<span class="pc" id="L534">        } catch(Exception ex) {</span>
<span class="nc" id="L535">            Debug.log(&quot;ERROR: PanelConverter.deserialize(), deleting &quot; + Main.converterSerLocation);</span>
<span class="nc" id="L536">            File deleteFile = new File(Main.converterSerLocation);</span>
<span class="nc" id="L537">            deleteFile.delete();</span>
        }
<span class="fc" id="L539">    }</span>

    private void serialize() {
        try {
<span class="pc bpc" id="L543" title="2 of 6 branches missed.">            if ((priceCurrency1 == 0 || priceCurrency2 == 0) &amp;&amp; (!buttonCurrency2.getText().equals(Main.currency))) return;</span>

<span class="fc" id="L545">            FileOutputStream file = new FileOutputStream(Main.converterSerLocation);</span>
<span class="fc" id="L546">            BufferedOutputStream buffer = new BufferedOutputStream(file);</span>
<span class="fc" id="L547">            ObjectOutputStream out = new ObjectOutputStream(buffer);</span>
<span class="fc" id="L548">            out.writeObject(buttonCurrency1.getText());</span>
<span class="fc" id="L549">            out.writeObject(buttonCurrency2.getText());</span>
<span class="fc" id="L550">            out.writeObject(fieldCurrency1.getText());</span>
<span class="fc" id="L551">            out.writeObject(fieldCurrency2.getText());</span>
<span class="fc" id="L552">            out.writeObject(priceCurrency1);</span>
<span class="fc" id="L553">            out.writeObject(priceCurrency2);</span>
<span class="fc" id="L554">            out.writeObject(infoCurrency1);</span>
<span class="fc" id="L555">            out.writeObject(infoCurrency2);</span>
<span class="fc" id="L556">            out.close();</span>
            //Debug.log(&quot;Serialized Converter To &quot; + Main.converterSerLocation); // too noisy
<span class="pc" id="L558">        } catch(Exception ex) {</span>
<span class="nc" id="L559">            Debug.log(&quot;EXCEPTION: PanelConverter.java - serialize()&quot;);</span>
<span class="nc" id="L560">            ex.printStackTrace();</span>
        }
<span class="fc" id="L562">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>